# spark任务gc耗时多，如何设置资源参数

## spark.storage.memoryFraction
### 参数说明：
该参数用于设置RDD持久化数据在Executor内存中能占的比例，默认是0.6。
也就是说，默认Executor 60%的内存，可以用来保存持久化的RDD数据。
根据你选择的不同的持久化策略，如果内存不够时，可能数据就不会持久化，或者数据会写入磁盘。

### 参数调优建议：
如果Spark作业中，有较多的RDD持久化操作，该参数的值可以适当提高一些，保证持久化的数据能够容纳在内存中。
避免内存不够缓存所有的数据，导致数据只能写入磁盘中，降低了性能。
但是如果Spark作业中的shuffle类操作比较多，而持久化操作比较少，那么这个参数的值适当降低一些比较合适。
此外，如果发现作业由于频繁的gc导致运行缓慢（通过spark web ui可以观察到作业的gc耗时），意味着task执行用户代码的内存不够用，那么同样建议调低这个参数的值。

### 结论：
gc多，调低spark.storage.memoryFraction值（默认是0.6）。
